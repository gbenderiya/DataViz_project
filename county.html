<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>County Details</title>
  <style>
    /* Ensure full viewport coverage */
    body {
      margin: 0;
    }
    #county-map-container {
      width: 100vw;
      height: 100vh;
    }
    .county-map {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <h1>County Details</h1>
  <div id="county-map-container">
    <svg id="county-map" class="county-map"></svg>
  </div>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson-client@3"></script> 
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const countyName = urlParams.get('county');
    console.log("County Name:", countyName); // Debugging: Log county name to console

    d3.json("counties-albers-10m.json").then(function(us) {
      console.log("Data loaded:", us); // Debugging: Log loaded data to console

      const path = d3.geoPath();

      const county = topojson.feature(us, us.objects.counties).features.find(function(d) {
        return d.properties.name === decodeURIComponent(countyName);
      });
      console.log("Selected County:", county); // Debugging: Log selected county to console

      // Modify the SVG element
      const countyMap = d3.select("#county-map")
        .attr("viewBox", [0, 0, 975, 610])
        .attr("preserveAspectRatio", "xMidYMid meet")
        .classed("county-map", true);

      // Modify the containing div
      const countyMapContainer = d3.select("#county-map-container")
        .style("width", "100%")
        .style("height", "100%");

      const g = countyMap.append("g");

      g.append("path")
        .datum(county)
        .attr("d", path)
        .attr("fill", "steelblue");

      // Add county name label
      g.append("text")
        .datum(county)
        .attr("x", path.centroid(county)[0])
        .attr("y", path.centroid(county)[1])
        .attr("text-anchor", "middle")
        .attr("font-size", "14px")
        .text(county.properties.name);
    }).catch(function(error) {
      console.error("Error loading data:", error);
    });
  </script>
</body>
</html>
